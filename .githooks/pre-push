#!/bin/sh
# Pre-push hook for Commentia project
# Runs tests and build checks before pushing

echo "ğŸš€ Running pre-push checks..."

# Get the remote and branch being pushed to
remote="$1"
url="$2"

# Run full project checks
echo "ğŸ” Running full project lint check..."
if ! npx biome check --write .; then
  echo "âŒ Lint check failed. Please fix all issues before pushing."
  exit 1
fi

echo "ğŸ”§ Running full TypeScript check..."
if ! npm run type-check; then
  echo "âŒ TypeScript check failed. Please fix all type errors before pushing."
  exit 1
fi

echo "ğŸ—ï¸ Running build check..."
if ! npm run build; then
  echo "âŒ Build failed. Please fix build errors before pushing."
  exit 1
fi

echo "ğŸ§ª Running tests..."
if ! npm run test; then
  echo "âŒ Tests failed. Please fix failing tests before pushing."
  exit 1
fi

echo "âœ… All pre-push checks passed!"
echo "ğŸ‰ Ready to push to $remote"
exit 0